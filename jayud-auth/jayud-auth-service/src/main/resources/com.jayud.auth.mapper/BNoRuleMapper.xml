<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jayud.auth.mapper.BNoRuleMapper">

    <!-- 通用查询映射结果ss -->
    <resultMap id="BaseResultMap" type="com.jayud.auth.model.po.BNoRule">
        <id column="id" property="id" />
        <result column="no_code" property="noCode" />
        <result column="no_desc" property="noDesc" />
        <result column="no_prefix" property="noPrefix" />
        <result column="no_format" property="noFormat" />
        <result column="check_length" property="checkLength" />
        <result column="check_table" property="checkTable" />
        <result column="check_database" property="checkDatabase" />
        <result column="t_num" property="tNum" />
        <result column="remark" property="remark" />
        <result column="crt_by" property="crtBy" />
        <result column="crt_by_name" property="crtByName" />
        <result column="crt_by_dtm" property="crtByDtm" />
        <result column="mdy_by" property="mdyBy" />
        <result column="mdy_by_name" property="mdyByName" />
        <result column="mdy_by_dtm" property="mdyByDtm" />
        <result column="voided" property="voided" />
        <result column="voided_by" property="voidedBy" />
        <result column="voided_by_name" property="voidedByName" />
        <result column="voided_by_dtm" property="voidedByDtm" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
            id, no_code, no_desc, no_prefix, no_format, check_length, check_table, check_database, t_num, remark, crt_by, crt_by_name, crt_by_dtm, mdy_by, mdy_by_name, mdy_by_dtm, is_deleted
    </sql>

    <!-- 表名 -->
    <sql id="tname">b_no_rule </sql>

    <sql id="selects">
        SELECT <include refid="Base_Column_List"/>
        FROM <include refid="tname"/>
        <where>
            is_deleted = 0
            <if test="bNoRule.noCode != null and bNoRule.noCode != ''">
                AND no_code = #{bNoRule.noCode}
            </if>

            <if test="bNoRule.noDesc != null and bNoRule.noDesc != ''">
                AND no_desc = #{bNoRule.noDesc}
            </if>

            <if test="bNoRule.noPrefix != null and bNoRule.noPrefix != ''">
                AND no_prefix = #{bNoRule.noPrefix}
            </if>

            <if test="bNoRule.noFormat != null and bNoRule.noFormat != ''">
                AND no_format = #{bNoRule.noFormat}
            </if>

            <if test="bNoRule.checkLength != null and bNoRule.checkLength != ''">
                AND check_length = #{bNoRule.checkLength}
            </if>

            <if test="bNoRule.checkTable != null and bNoRule.checkTable != ''">
                AND check_table = #{bNoRule.checkTable}
            </if>

            <if test="bNoRule.checkDatabase != null and bNoRule.checkDatabase != ''">
                AND check_database = #{bNoRule.checkDatabase}
            </if>

            <if test="bNoRule.tNum != null ">
                AND t_num = ${bNoRule.tNum}
            </if>

            <if test="bNoRule.remark != null and bNoRule.remark != ''">
                AND remark = #{bNoRule.remark}
            </if>

            <if test="bNoRule.crtBy != null ">
                AND crt_by = ${bNoRule.crtBy}
            </if>

            <if test="bNoRule.crtByName != null and bNoRule.crtByName != ''">
                AND crt_by_name = #{bNoRule.crtByName}
            </if>

            <if test="bNoRule.crtByDtm != null ">
                AND crt_by_dtm = ${bNoRule.crtByDtm}
            </if>

            <if test="bNoRule.mdyBy != null ">
                AND mdy_by = ${bNoRule.mdyBy}
            </if>

            <if test="bNoRule.mdyByName != null and bNoRule.mdyByName != ''">
                AND mdy_by_name = #{bNoRule.mdyByName}
            </if>

            <if test="bNoRule.mdyByDtm != null ">
                AND mdy_by_dtm = ${bNoRule.mdyByDtm}
            </if>

            <if test="bNoRule.isDeleted != null ">
                AND is_eleted = ${bNoRule.isDeleted}
            </if>

        </where>
    </sql>

    <select id="pageList" resultMap="BaseResultMap" parameterType="com.jayud.auth.model.po.BNoRule">
        <include refid="selects"/>
    </select>

    <select id="list" resultMap="BaseResultMap" parameterType="com.jayud.auth.model.po.BNoRule">
        <include refid="selects"/>
    </select>


    <delete id="phyDelById">
        DELETE FROM  b_no_rule WHERE id = ${id}
    </delete>

    <update id="logicDel">
        UPDATE b_no_rule SET is_deleted = 1 ,update_by = #{username}, update_time = now()
        WHERE id = ${id} AND is_deleted = 0
    </update>

    <select id="getNoRulesBySheetCode" resultType="com.jayud.auth.model.po.BNoRule" >
        select * from b_no_rule where no_code = #{sheetCode}
    </select>

</mapper>
