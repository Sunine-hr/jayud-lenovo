<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jayud.mall.mapper.ReceivableBillMasterMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.jayud.mall.model.po.ReceivableBillMaster">
        <id column="id" property="id" />
        <result column="bill_code" property="billCode" />
        <result column="order_id" property="orderId" />
        <result column="legal_person_id" property="legalPersonId" />
        <result column="customer_id" property="customerId" />
        <result column="amount" property="amount" />
        <result column="cid" property="cid" />
        <result column="remarks" property="remarks" />
        <result column="status" property="status" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, bill_code, order_id, legal_person_id, customer_id, amount, cid, remarks, status
    </sql>


    <select id="findReceivableBillMasterByPage" parameterType="com.jayud.mall.model.bo.QueryReceivableBillMasterForm"
            resultType="com.jayud.mall.model.vo.ReceivableBillMasterVO">
        select
        t.id,t.bill_code,t.order_id,t.legal_person_id,t.customer_id,t.amount,t.cid,t.remarks,t.status,t.create_time,
        t1.order_no,
        t2.legal_entity,
        t3.company customerName,
        t4.currency_code,t4.currency_name
        from receivable_bill_master t
        left join order_info t1 on t1.id = t.order_id
        left join legal_person t2 on t2.id = t.legal_person_id
        left join customer t3 on t3.id = t.customer_id
        left join currency_info t4 on t4.id = t.cid
        where 1=1
        <if test="form.billCode != null and form.billCode != ''">
            and t.bill_code = #{form.billCode}
        </if>
        <if test="form.orderNo != null and form.orderNo != ''">
            and t1.order_no = #{form.orderNo}
        </if>
        <if test="form.customerId != null">
            and t.customer_id = #{form.customerId}
        </if>
        <if test="form.status != null">
            and t.status = #{form.status}
        </if>
    </select>

</mapper>
